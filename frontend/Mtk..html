<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My token</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
</head>
<body>
    <h2>Simple dApp</h2>
    <button onclick="connectWallet();">Connect Metamask</button>
    <p id="wallet">Wallet: not connected</p>
    <input type="text" id="address" placeholder="Enter address" />
    <button onclick="CheckBalance();">Check balance</button>
    <p id="balance"></p>


    <script>
        let provider;
        let contract;
        let signer;

        const addressToken = "0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512";
        const tokenABI = [
            "function balanceOf(address) view returns(uint)",
            "function decimals() view returns(uint)"
        ];

        async function connectWallet() {
            if (window.ethereum) {
                provider = new ethers.provides.Web3Proivder(window.ethereum);
                await provider.send("eth_requestAccounts", []);
                signer = provider.getSigner();
                const userAddress = await signer.getAddress();

                document.getElementById("wallet").innerText = "Wallet: " + userAddress;

                contract = new ethers.Contract(addressToken, tokenABI, provider);

            } else {
                alert("Metamaks not found")
            }
        }


        async function checkBalance() {
            const address = document.getElementById("address").value;
            if (!address) return alert("Enter an address");

            const balance = await contract.balanceOf(address);
            const decimals = await contract.decimals();

            const readableBalance = ethers.utils.formatUnits(balance, decimals);

            document.getElementById("balance").innerText = "Balance: " + readableBalance;
        }
    </script>
</body>
</html>